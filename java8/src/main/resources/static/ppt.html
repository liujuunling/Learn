<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
    <title></title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mui/3.7.1/css/mui.css" rel="stylesheet" />
</head>
<body>
<header class="mui-bar mui-bar-nav">
    <h1 class="mui-title">文件预览</h1>
</header>
<div class="mui-content">
    <a>WebApp推送方式.docx</a>
</div>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mui/3.7.1/js/mui.js"></script>
<script>
    mui.init();
    var domanUrl = "192.168.1.1/Fiel/";//为存放文件目录地址
    //获取地址
    mui(".mui-content").on("tap", "a", function() {
        var fileName = mui(this)[0].innerHTML;
        openFile(domanUrl + fileName)
    })
    //文件下载及打开第三方软件预览
    function openFile(url) {
        //创建一个下载任务
        var dtask = plus.downloader.createDownload(url, {}, function(d, status) {
            if(status == 200) {
                var fileUrl = d.filename;
                plus.runtime.openFile(fileUrl, {}, function(e) {
                    alert('打开失败');
                });
            } else {
                alert("Download failed: " + status);
            }
        });
        dtask.start();
    }
</script>
</body>
</html>
